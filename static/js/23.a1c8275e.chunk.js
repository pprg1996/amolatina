(this.webpackJsonpivan=this.webpackJsonpivan||[]).push([[23],{407:function(e,t,n){"use strict";n.r(t);var i=n(4),r=n(2),a=n.n(r),s=n(8),o=n(9),c=n(5),l=n(78),d=n(7),u=n(10),b=n(157),j=n(0),p=n(130),f=n(221),O=n(11),h=n.n(O),m=n(40),g=n(1),v=Object(j.lazy)((function(){return n.e(19).then(n.bind(null,382))})),x=Object(j.lazy)((function(){return Promise.all([n.e(4),n.e(11)]).then(n.bind(null,394))})),S=Object(j.lazy)((function(){return Promise.all([n.e(4),n.e(9),n.e(14)]).then(n.bind(null,390))})),y=c.d.div.withConfig({displayName:"Perfiles__PerfilesDiv",componentId:"m36yex-0"})(["margin-top:12px;padding:20px 48px 20px 16px;display:grid;gap:32px;grid-template-columns:repeat(4,minmax(0,1fr));overflow-x:hidden;align-items:start;",""],l.b);t.default=function(e){var t,n=e.orden,r=e.multasOAvisos,c=Object(u.d)(["perfiles"],d.fetchPerfiles).data,l=Object(u.d)(["operadores"],d.fetchOperadores).data,O=null===l||void 0===l||null===(t=l.find((function(e){return e.id===+h.a.get("id")})))||void 0===t?void 0:t.pausado,k=Object(j.useContext)(p.a),C=Object(j.useState)(!1),T=Object(o.a)(C,2),w=T[0],M=T[1],P=Object(j.useState)(!1),D=Object(o.a)(P,2),F=D[0],I=D[1],B=Object(j.useState)(!1),J=Object(o.a)(B,2),L=J[0],_=J[1],z=Object(j.useState)(0),A=Object(o.a)(z,2),N=A[0],Q=A[1],E=h.a.get("role"),H=+h.a.get("id"),U=Object(j.useState)(!1),Y=Object(o.a)(U,2),q=Y[0],G=Y[1],K=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var i,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(!0),(i=t.currentTarget).disabled=!0,e.next=5,Object(d.customFetch)("/profiles/select",{headers:{"Content-Type":"application/json"},body:JSON.stringify({list_id:[n]}),method:"POST"});case 5:r=e.sent,Object(d.errorPerfilesToast)(r,"toma"),setTimeout((function(){u.b.invalidateQueries("perfiles"),G(!1),i.disabled=!1}),2e3);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var i,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(!0),(i=t.currentTarget).disabled=!0,e.next=5,Object(d.customFetch)("/profiles/release",{headers:{"Content-Type":"application/json"},body:JSON.stringify({list_id:[n]}),method:"POST"});case 5:r=e.sent,Object(d.errorPerfilesToast)(r,"liberacion"),setTimeout((function(){u.b.invalidateQueries("perfiles"),G(!1),i.disabled=!1}),2e3);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(g.jsxs)(y,{children:[null===c||void 0===c?void 0:c.filter((function(e){return e.activo})).sort((function(e,t){var i=function(e){var t;return(null===(t=e.operador)||void 0===t?void 0:t.id)===H?2e6:0},r=function(e){return e.libre?1e6:0};return"dia"===n?t.progresoDia+i(t)+r(t)-(e.progresoDia+i(e)+r(e)):t.progresoMes+i(t)+r(t)-(e.progresoMes+i(e)+r(e))})).map((function(e){for(var t,n,a=0,s=0;s<((null===k||void 0===k?void 0:k.length)||-1);s++)if(e.id===+k[s].perfilId&&"feeds"===k[s].tablename){var o=new Date(k[s].timestamp);a=Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds());break}return Object(g.jsxs)(j.Fragment,{children:[Object(g.jsx)(f.b,{id:""+e.id,children:q?Object(g.jsx)(m.a,{}):Object(g.jsx)(b.a,Object(i.a)(Object(i.a)({},Object(i.a)(Object(i.a)({},e),{},{summary1:e.diaSummary,summary2:e.mesSummary,puntos1:e.progresoDia,puntos2:e.progresoMes,latestFeedTimestamp:a,usarMultasOAvisos:r})),{},{tipoEntidad:"perfil"}),e.id)}),+h.a.get("id")!==d.ghostAdminId?Object(g.jsxs)(f.a,{id:""+e.id,children:["admin"!==E&&e.libre&&!O?Object(g.jsx)(f.c,{onClick:function(t){return K(t,e.id)},children:"Tomar"}):null,"admin"===E||(null===(t=e.operador)||void 0===t?void 0:t.id)!==H||O?null:Object(g.jsx)(f.c,{onClick:function(t){return R(t,e.id)},children:"Liberar"}),Object(g.jsx)(f.c,{onClick:function(){_(!0),Q(e.id)},children:"Configurar Token"}),(null===(n=e.operador)||void 0===n?void 0:n.id)===H?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(f.c,{onClick:function(){M(!0),Q(e.id)},children:"Configurar Bot 24"}),Object(g.jsx)(f.c,{onClick:function(){I(!0),Q(e.id)},children:"Configurar Super Bot"})]}):null]}):null]},e.id)})),L?Object(g.jsx)(j.Suspense,{fallback:Object(g.jsx)("div",{children:"Loading..."}),children:Object(g.jsx)(v,{perfilId:N,setShowTokenModal:_})}):null,w?Object(g.jsx)(j.Suspense,{fallback:Object(g.jsx)("div",{children:"Loading..."}),children:Object(g.jsx)(x,{perfilId:N,setShowCartas24BotModal:M})}):null,F?Object(g.jsx)(j.Suspense,{fallback:Object(g.jsx)("div",{children:"Loading..."}),children:Object(g.jsx)(S,{perfilId:N,setShowSuperCartasBotModal:I})}):null]})}}}]);